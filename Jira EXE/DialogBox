import tkinter as tk
from tkinter import filedialog
from datetime import datetime
import os
import tempfile

def submit_values():
    email = email_entry.get()
    file_path = file_path_entry.get()
    number = number_entry.get()
    
    # Get the current timestamp
    timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    
    # Create a temporary directory for storing the log file
    with tempfile.TemporaryDirectory() as temp_dir:
        log_file_path = os.path.join(temp_dir, "input_log.txt")
        input_file_path = os.path.join(temp_dir, "input_values.txt")

    # Get the directory path of the executable
    # exe_directory = os.path.dirname(os.path.abspath(__file__))

    # Create the log file path in the same directory as the executable
    # log_file_path = os.path.join(exe_directory, "input_log.txt")
    # input_file_path = os.path.join(exe_directory, "input_values.txt")

   # Save the values to a file
    with open("input_values.txt", "w") as file:
        file.write(f"Email: {email}\n")
        file.write(f"File Path: {file_path}\n")
        file.write(f"Number: {number}\n")

    # Append the values to the log file
    with open("input_log.txt", "a") as log_file:
        log_file.write(f"Timestamp: {timestamp}\n")
        log_file.write(f"Email: {email}\n")
        log_file.write(f"Number: {number}\n")
        log_file.write("---\n")
    
    # Clear the input fields
    email_entry.delete(0, tk.END)
    file_path_entry.delete(0, tk.END)
    number_entry.delete(0, tk.END)
    
    window.destroy()

def browse_file():
    file_path = filedialog.askopenfilename()
    file_path_entry.delete(0, tk.END)
    file_path_entry.insert(tk.END, file_path)

# Create the main window
window = tk.Tk()
window.title("Jira Onboarding")

# Set the custom icon (replace "path/to/icon.ico" with the actual path to your icon file)
window.iconbitmap("C:\\Users\\matt.hebert\\OneDrive - Cybersoft Technologies\\Desktop\\CS_Icon.ico")

# Set the dialog box size
window.geometry("500x200")  # Adjust the size as needed (width x height)

# Configure the font style and size for labels and buttons
label_font = ("Arial", 12)  # Adjust the font style and size as needed
button_font = ("Arial", 10)  # Adjust the font style and size as needed

# Create and grid the input fields
email_label = tk.Label(window, text="Enter Your Email:", font=label_font)
email_label.grid(row=0, column=0, padx=5, pady=5, sticky="e")
email_entry = tk.Entry(window, font=label_font)
email_entry.grid(row=0, column=1, padx=5, pady=5)

file_path_label = tk.Label(window, text="Select API Key File:", font=label_font)
file_path_label.grid(row=1, column=0, padx=5, pady=5, sticky="e")
file_path_entry = tk.Entry(window, font=label_font)
file_path_entry.grid(row=1, column=1, padx=5, pady=5)
browse_button = tk.Button(window, text="Browse", command=browse_file, font=button_font)
browse_button.grid(row=1, column=2, padx=5, pady=5)

number_label = tk.Label(window, text="Ticket Number:", font=label_font)
number_label.grid(row=2, column=0, padx=5, pady=5, sticky="e")
number_entry = tk.Entry(window, font=label_font)
number_entry.grid(row=2, column=1, padx=5, pady=5)

submit_button = tk.Button(window, text="Create User", command=submit_values, font=button_font)
submit_button.grid(row=3, column=1, padx=5, pady=5)

# Start the Tkinter event loop
window.mainloop()